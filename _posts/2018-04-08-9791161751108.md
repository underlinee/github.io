---
layout: post
title:  "스프링 5.0 마이크로서비스 - MSA 관련 아키텍처 스타일"
date:   2018-04-08 00:00:01
group: 책읽고밑줄
booklink: "http://www.aladin.co.kr/shop/wproduct.aspx?ItemId=132176859"
bookimg: "http://image.aladin.co.kr/product/13217/68/cover/k462532593_1.jpg"
tags:	스프링5.0마이크로서비스 MSA 
---

## 12 요소 애플리케이션
12 요소 애플리케이션은 클라우드에서 운영 가능한 현대적인 애플리케이션에서 기대할 수 있는 특징이다. 12 요소 애플리케이션은 마이크로 서비스에도 동일하게 적용할 수 있다. 

- **단일 코드 베이스**: 하나의 마이크로서비스는 정확히 하나의 코드 베이스를 가진다. 

> 어디까지를 하나의 마이크로서비스로 볼 것인지가 어려운 문제가 될 수 있다. 이론과 달리 현실에서는 같은 역할과 동작을 담당한다고 해도 상황에 따라 코드베이스를 분리해야하는 경우가 존재한다.
{: .memo}


- **의존성 꾸러미**: 모든 어플리케이션은 필요한 모든 의존성을 애플리케이션과 함께 하나의 꾸러미에 담는다. 즉 최종 실행 파일은  war나 jar등으로 패키징되어 모든 의존성을 포함한다. 
- **환경설정 외부화**: 모든 환경설정 파라미터를 코드와 분리해서 외부화한다. 환경에 따라 달라지는 유일한 것은 환경설정 파라미터밖에 없기 때문에 출시나 배포 프로세스 자동화에 도움이 된다. 
- **후방지원 서비스 접근성**: 모든 후방 지원 서비스는 복잡한 커뮤니케이션 없이 URL을 통해 접근 가능해야 한다. 일반적으로 REST와 JSON을 사용하는 HTTP를 호출한다. 
- **빌드, 출시, 운영의 격리**: 빌드, 출시, 운영을 뚜렷하게 격리한다. 빌드는 컴파일하여 바이너리를 만들어내는 것이며, 출시는 바이너리를 환경설정 파라미터와 혼합하는 것이다. 
- **무상태, 비공유 프로세스**: 애플리케이션이 상태를 갖지 않으면 장애 대응성이 좋고 쉽게 확장할 수 있다. 
- **서비스를 포트에 바인딩해서 노출**: 외부 웹서버 등에 의존하지 않고 자기 완비적이거나 독립 설치형이어야 한다. 포트 바인딩은 이를 위한 기본적인 요구사항 중 하나다. 
- **확장을 위한 동시성**: 복제를 통해 프로세스가 확장될 수 있게 설계해야 한다. 이를 통해 트래픽 규모에 따라 탄력적으로 확장되거나 축소될 수 있다. 
- **폐기 영향 최소화**: 시동과 종료에 필요한 시간을 최소화하고 서버가 종료될 때에는 종료에 필요한 작업이 모두 수행되는 방식이어야 한다. 이러한 방식은 자동 확장을 용이하게 한다.
- **개발과 운영의 짝 맞춤**: 개발 환경과 운영 환경을 가능한 한 동일하게 유지하는 것이 중요하다. 이는 마이크로서비스만이 아니라  모든 애플리케이션 개발에 적용되어야 한다. 
- **로그 외부화**: 병목을 피하기 위해 로컬 I/O를 피하는 것이 좋고, 중앙 집중식 로깅 프레임워크를 이용하여 로그 파일을 자기 자신 안에 담지 않는다. 
- **관리자 프로세스 패키징**: 관리자용 태스크는 애플리케이션과 동일한 환경에서 실행되어야 한다. 이를 위해 관리자용 태스크 코드도 애플리케이션 코드와 함께 패키징되어야 한다. 

<br/>

## 서버리스 컴퓨팅
서버리스 컴퓨팅에서는 개발자가 애플리케이션 서버, 가상머신, 컨테이너, 인프라스트럭처, 확장성 등에 대해 고민하지 않고 비즈니스 로직을 작성해서 컴퓨터 인프라스터럭처에 떨구기만 하면 된다. 서버리스는 마이크로 서비스 기반 아키텍처를 따른다. 서버리스는 한 번에 하나의 임무만 수행하고 외부와 격리되어 있으며, 이벤트 기반 혹은 HTTP 기반의 API를 통해서만 외부와 통신한다. 

<br/>

## 리액티브 마이크로서비스
비즈니스 범위를 기반으로 서비스를 분리하는 것만으로는 의존 관계 이슈를 해결하기 어렵다. 그래서 마이크로 서비스를 성공적으로 구현하기 위해 리액티브 스타일을 도입하는 것이 중요하다. 

격리가 잘 이루어지면, 한 서비스의 장애가 다른 서비스에 영향을 미치지 않게 된다. 장애가 발생하면 폴백 서비스나 동일한 서비스의 복제본이 장애가 발생한 서비스의 역할을 일시적으로 대신한다. 격리된 컴포넌트는 독립적으로 확장, 관리, 모니터링이 가능해진다. 격리되어 있다고 하더라도 서비스간 의존이 동기 블로킹 방식으로 구성된다면 완전히 격리된 것도 아니며 장애도 전파될 수 있다.  

높은 확장성과 신뢰성을 가진 메시지 시스템은 외부에서 들어오는 이벤트를 접수하고 자체적인 이벤트를 생성해서 발생한다. 각 서비스는 독립적이며 협력하는 다른 서비스의 존재를 알지 못한다. 새로운 서비스는 필요에 따라 추가될 수 있으며 기존 서비스에 영향을 미치지 않는다. 

<br/>