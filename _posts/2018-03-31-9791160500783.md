---
layout: post
title:  "유지보수 가능한 코딩의 기술 - 클린코드의 비밀"
date:   2018-03-30 18:43:59
group: 책읽고밑줄
booklink: "http://www.aladin.co.kr/shop/wproduct.aspx?ItemId=98546964"
bookimg: "http://image.aladin.co.kr/product/9854/69/cover/k292535351_1.jpg"
tags:	유지보수가능한코딩의기술 클린코드
---


## 코드 단위를 짧게 하라
단위(메서드)는 짧을수록 분석, 테스트, 재사용하기가 좋습니다. 코드 단위는 15라인을 넘어가지 않게 작성합니다. 메서드를 추출하거나 메서드를 메서드 객체로 대체(Replace Method with Method Object) 리팩터링 기법을 사용합니다. 

<br/>

## 코드 단위는 간단하게 짜라
분기가 적을 수록 단위를 분석/테스트하기 더 쉽습니다. 복잡도를 객관적으로 산출하는 가장 직관적인 방법은 코드 조각을 지나는 분기의 수를 세어보는 것입니다. 본기점 개수 + 1을 맥캐브 복잡도라고 합니다. 맥캐브 복잡도는 5 이하로 제한합니다. 이를 어기는 경우 중 조건문 체인이 있는 경우가 많은데, 조건을 다형성으로 대체(Replace Conditional with Polymorphism) 리팩터링 기법을 사용할 수 있습니다. 다만 여러 클래스가 코드로 흩어지는 단점은 있습니다. 확장성이냐 간결함이냐, 선택은 개발자의 몫입니다. 

<br/>

## 코드는 한 번만 작성하라
뭐 하나 고치려면 사본마다 한 번씩 손을 대야 하니 소스 코드 중복은 무조건 피하는 게 상책입니다. 중복되는 부분에 메서드 추출 이나 상위 클래스 추출(Extract Superclass) 기법을 사용합니다. 절대 코드가 바뀌지 않을 거란 생각은 미신에 불과합니다. 복사를 허용하는 건 훗날 누군가 사고를 친 이후 맞닥뜨려야 할 리스크를 인정하는 행위와 다름없습니다. 

<br/>

## 단위 인터페이스를 작게 하라
파라미터가 적은 단위는 재사용, 테스트하기 편합니다. 단위당 파라미터 개수를 4개 이하로 제한하도록 합니다. 파라미터 객체를 만들어서 파라미터를 한데 모아 객체를 만드는 기법으로 수정할 수 있습니다. 큰 인터페이스를 리팩터링해도 여전히 다른 메서드에 많은 파라미터를 넘길 수 밖에 없는 경우가 있을 수 있습니다. 쉬운 작업은 아니지만, 메서드 내부에서 벌어지는 일들을 계속 분할하면서 파라미터를 별개로 조작하는 방식으로 접근해봅시다. 

<br/>

## 관심사를 모듈(클래스, 인터페이스) 로 분리하라
느슨하게 결합된 모듈이 고치기 쉽고 시스템을 더욱 모듈화하는 방향으로 이끕니다. 덩치 큰 클래스가 나타나지 않도록, 개별 모듈로 나누어 일을 시키고 구현 상세는 인터페이스 안으로 감춥니다. 

<br/>

## 아키텍처 컴포넌트를 느슨하게 결합하라
느슨하게 결합된 최상위 시스템 컴포넌트가 수정하기 더 쉽고 시스템을 모듈화할 여지가 많습니다. 가능한 캡슐화하여 다른 컴포넌트 모듈에 호출을 받는 형태로 공개된 모듈 내부의 상대적인 코드량을 최소화합니다. 개발 초기부터 컴포넌트의 역할의 경계선을 확실히 긋고 컴포넌트간 의존성을 적게 해야합니다. 이 책은 아키텍처를 다루지는 않지만 하나만 언급한다면, 느슨하게 결합한 시스템의 특징은 규약에 더 의존하고 상세 구현부엔 덜 의존한다는 점입니다. 

<br/>

## 아키텍처 컴포넌트의 균형을 잡아라
컴포넌트가 넘치거나 모자라지 않게 크기를 거의 비슷하게 균형을 맞춰 모듈화한 아키텍처는 관심사를 분리할 수 있고 고치기가 쉽습니다. 최상위 수준 컴포넌트 개수와 상태적 크기의 균형을 잡습니다. 시스템 로직이 너무 많은 것을 매우 큰 컴포넌트 몇개에 넣고 다른 작은 컴포넌트가 여럿 배치되어 있다면 컴포넌트 균형이 어긋난 것입니다. 이를 위해 시스템 도메인을 명확히 알고 일관되게 적용하도록 기능을 컴포넌트에 올바르게 분류해야 합니다. 일관성이 결여된 아키텍처는 나쁜 아키텍처입니다.  

> 글쓰기를 할 때 문단의 크기를 비슷하게 하는 것과 마찬가지다. 문단 간 균형이 맞지 않으면 글 전체의 균형이 잡히지 않아 글의 메시지가 불명확한 경우가 있다. 불필요한 부분을 없애거나 부족한 부분을 채워넣어야 한다.
{: .memo}

<br/>

## 코드베이스를 작게 하라
코드베이스는 소스 코드 뭉치로 컴파일 및 배포를 독립적으로 수행하는 단위 입니다. 코드 베이스의 덩치 큰 시스템은 분석, 수정, 테스트할 때 코드가 더 많이 필요해서 유지보수가 쉽지 않습니다. 또 많은 사람이 동원되고 설계는 복잡하며 수행기간은 깁니다. 결국 프로젝트 실패 가능성을 높이게 됩니다. 코드 베이스가 커지는 걸 막고 시스템 크기를 적극적으로 줄어야 합니다. 이를 위해서 기능 추가에 대해 대가를 협의하면서 맞서야 하면, 기준을 표준화하여 프로그램 로직과 움직임을 일관적으로 유지해야 합니다. 

<br/>

## 테스트를 자동화하라
테스트를 자동화하면 수정한 결과를 거의 실시간으로 피드백 받을 수 있습니다. 테스트 케이스에서는 정상 케이스, 특이 케이스를 모두 테스트하고, 테스트 코드를 제품 코드 처럼 관리해야 합니다. 제품 코드와 테스트 코드 비율을 1:1로 하는 것을 권장합니다. 

<br/>

## 클린 코드를 작성하라
새로운 팀원이 들어와도 생산적으로 근무하기 위해 코드베이스를 클린한 상태로 유지해야 합니다. 클린 코드는 곧 유지보수 가능한 코드라서 유지보수성이 개선됩니다. 개발자 7대 "보이 스카우트 규칙"은 다음과 같습니다. 
```
1. 단위 수준의 코드 악취를 남기지 말라
2. 나쁜 주석을 남기지 말라.
3. 주석 안에 코드를 남기지 말라
4. 죽은 코드를 남기지 말라
5. 긴 식별자 이름을 남기지 말라
6. 매직 상수를 남기지 말라
7. 제대로 처리 안 한 예외를 남기지 말라
```

<br/>
