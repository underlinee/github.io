<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>이펙티브 파이썬 - 클래스와 상속</title>
  <meta name="description" content="인터페이스가 간단하면 클래스 대신 함수를 받자파이썬에서 함수와 메서드는 일급이다. 즉 다른 타입처럼 표현식에서 사용할 수 있다. 간단한 인터페이스 용으로 함수만 사용할 수 있지만, 상태를 보존하는 함수가 필요할 때__call__ 이라는 메서드를 제공하는 클래스를 정의해서 문제를 해...">
  
  <meta name="author" content="JB">
  <meta name="copyright" content="&copy; JB 2018">
  

  <!-- External libraries -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/monokai-sublime.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/css/lightbox.css">

  <!-- Favicon and other icons (made with http://www.favicon-generator.org/) -->
  <link rel="shortcut icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="57x57" href="/assets/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/assets/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">
  <link rel="manifest" href="/assets/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  

  

  

  <!-- Site styles -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://underlinee.github.io/devbook/2018/03/04/9791186978825.html">
  <link rel="alternate" type="application/rss+xml" title="Underlinee" href="http://underlinee.github.io/feed.xml" />
</head>


  <body>

    <header class="navigation" role="banner">
  <div class="navigation-wrapper">
    <!-- <a href="/" class="logo">
      
      <img src="/assets/logo.png" alt="Underlinee">
      
    </a> -->
    <a href="javascript:void(0)" class="navigation-menu-button" id="js-mobile-menu">
      <i class="fa fa-bars"></i>
    </a>
    <nav role="navigation">
      <ul id="js-navigation-menu" class="navigation-menu show">
        
          
        
          
          <li class="nav-link"><a href="/bookshelf/">Bookshelf</a>
          
        
          
        
          
        
          
        
          
          <li class="nav-link"><a href="/posts/">Posts</a>
          
        
          
        
          
        
      </ul>
    </nav>
  </div>
</header>


    <div class="page-content">
        <div class="post">

<div class="post-header-container " >
  <div class="scrim ">
    <header class="post-header">
      <h1 class="title">이펙티브 파이썬 - 클래스와 상속</h1>
    </header>
  </div>
</div>

<div class="wrapper">

 <span class="page-divider">
  <span class="one"></span>
  <span class="two"></span>
</span>
 

<section class="post-meta">
  <div class="post-date">March 4, 2018</div>
  <div class="post-categories">
  in 
    
    <a href="/category/DevBook">Devbook</a>
    
  
  </div>
</section>

<article class="post-content">
  <p><br /></p>
<h2 id="section">인터페이스가 간단하면 클래스 대신 함수를 받자</h2>
<p>파이썬에서 함수와 메서드는 일급이다. 즉 다른 타입처럼 표현식에서 사용할 수 있다. 간단한 인터페이스 용으로 함수만 사용할 수 있지만, 상태를 보존하는 함수가 필요할 때__call__ 이라는 메서드를 제공하는 클래스를 정의해서 문제를 해결하면 상태 보존 클로저라는 목적을 잘 드러난다.</p>
<div class="highlighter-rouge"><pre class="highlight"><code>class BetterCountMissing(object):
    def __init__(self):
        self.added = 0

    def __call__(self):
        self.added +=1
        return 0

counter = BetterCountMissing()
result = defaultdict(counter, current)

</code></pre>
</div>

<p><br /></p>

<h2 id="classmethod--">객체를 범용으로 생성하려면 @classmethod 다형성을 이용하자</h2>
<p>다형성을 이용하면 여러 클래스가 같은 인터페이스나 추상 기반 클래스를 충족하면서도 다른 기능을 제공할 수 있다. 다형성을 제공하기 위해서는 범용적으로 사용할 수 있는 특별한 생성자가 필요하다. @classmethod 데코레이터를 이용하여 클래스메서드를 생성하면 cls를 매개변수로 범용 생성자를 사용할 수 있다.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>class GenericInputData(object):
    def read(self):
        raise NotImplementedError

    @classmethod
    def generate_inputs(cls, config):
        raise NotImplementedError

class PathInputData(GenericInputData):
    def read(self):
        return open(self.path).read()

    @classmethod
    def generate_inputs(cls, config):
        data_dir = config['data_dir']
        for name in os.listdir(data_dir):
            yield cls(os.path.join(data_dir, name))
</code></pre>
</div>

<p><br /></p>

<h2 id="super---">super로 부모 클래스를 초기화하자</h2>
<p>부모 클래스의 __init__ 메서드를 사용하고 싶은 경우, 자식 클래스에서 부모 클래스의 __init__ 메서드를 직접 호출하여 부모 클래스를 초기화하는 방법이 있다. 이 방법은 간단한 계층 구조에서는 잘 동작하지만 다이아몬드 상속의 경우 부모의 __init__ 메서드를 두 번 호출하여 예상치 못한 결과를 일으키는 경우가 있다. 파이썬 2.2부터 MRO(Method Resolution Order) 를 정의하여 이 문제를 해결하였으며, 파이썬 3에서는 super() 를 호출하여 좀 더 간결하게 부모 클래스 초기화를 가능하게 했다.</p>
<div class="highlighter-rouge"><pre class="highlight"><code>class MyChildClass(MyParentClass):
    def __init__(self, value):
        super().__init__(value * 2)

</code></pre>
</div>

<p><br /></p>

<h2 id="section-1">믹스인 유틸리티 클래스에만 다중 상속을 사용하자</h2>
<p>다중 상속으로 얻는 편리함이 필요하다면 믹스인을 고려하자. 믹스인이란 클래스에서 제공해야 하는 추가적인 메서드만 정의하는 클래스를 말한다. 믹스인 클래스는 자체의 인스턴스 속성을 정의하지 않으며 __init__ 생성자를 호출하도록 요구하지 않는다. 간단한 동작들도 복잡한 기능을 생성하려면 믹스인을 조합하자. 파이썬은 다중 상속 지원하기는 하지만 아예 하지 않는 편이 낫다.</p>
<div class="highlighter-rouge"><pre class="highlight"><code>class JsonMixin(object):
    @classmethod
    def from_json(cls, data):
        kwargs = json.loads(data)
        return cls(**kwargs)

    def to_json(self):
        return json.dumps(self.to_dict)

</code></pre>
</div>

<p><br /></p>

<h2 id="section-2">비공개 속성보다는 공개 속성을 사용하자</h2>
<p>파이썬은 비공개 속성을 밑줄을 두 개 붙여 지정할 수 있지만, 엄격하게 강요하지 않는다. 단순히 비공개 필드의 이름을 변경하도록 구현되어 있어서, __MyObject__private_field로 접근하도록 변환하면 접근이 가능하다. 하지만 계층 구조가 변할 경우, 필드 할당의 주체가 바뀌면서  MyObject의 이름이 바뀔 가능성이 있기 때문에 문제가 될 수 있다. 비공개 필드를 처음부터 막기 보다는 문서화를 잘하자. 비공개 필드는 직접 제어할 수 없는 서브클래스의 필드와 이름이 겹치지 않게 할 때만 사용하는 것을 고려하는 것이 낫다.</p>
<div class="highlighter-rouge"><pre class="highlight"><code>class ApiClass(object):
    def __init__(self):
        self.__value = 5
        
    def get(self):
        return self.__value
    
class Child(ApiClass):
    def __init__(self):
        super().__init__()
        self._value = 'hello'
</code></pre>
</div>

<p><br /></p>

<h2 id="collectionsabc---">커스텀 컨테이너 타입은 collections.abc의 클래스를 상속받게 하자</h2>
<p>파이썬 프로그램의 대부분은 데이터를 담은 클래스를 정의하고 이 객체들이 연계되는 방법을 명시하는 일이다. 커스텀 컨테이터 타입을 정의할 때 쓰임새가 간단하거나 기존 컨테이너에서 필요한 동작만 추가하는 경우 list, dict 같은 파이썬 컨테이너 타입에서 직접 상속 받게 하자. 만일 좀 더 복잡한 커스텀이 필요한 경우 collections.abc의 추상기반 클래스를 상속 받자. 필요한 인터페이스와 동작을 일치 시킬 수 있다.</p>

<p><br /></p>

<p><a href="http://www.aladin.co.kr/shop/wproduct.aspx?ItemId=80277523">
  <img class="book" style="width: 30%; height: 30%" src="http://image.aladin.co.kr/product/8027/75/cover/k212434638_1.jpg" />
</a></p>

</article>



<section class="tags">
  <strong>Tags:</strong> <a href="/tag/비공개속성">비공개속성</a>,&nbsp;<a href="/tag/파이썬">파이썬</a>,&nbsp;<a href="/tag/classmethod">classmethod</a>,&nbsp;<a href="/tag/super">super</a>,&nbsp;<a href="/tag/mixin">mixin</a>,&nbsp;<a href="/tag/믹스인">믹스인</a>
</section>








<section class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = 'underlinee';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



</div>
</div>

    </div>

    <footer class="site-footer" style="background-image: url(/assets/footer_image.jpg)";>

  <div class="wrapper">

    <h3 class="footer-heading">Underlinee</h3>

    <div class="site-navigation">

      <p><strong>Site Map</strong></p>
      <ul class="pages">
        
        
        
        
          <li class="nav-link"><a href="/bookshelf/">Bookshelf</a>
        
        
        
        
        
        
        
        
        
          <li class="nav-link"><a href="/posts/">Posts</a>
        
        
        
        
        
        
      </ul>
    </div>

    <div class="site-contact">

      <p><strong>Contact</strong></p>
      <ul class="social-media-list">
        <li>
          <a href="mailto:jb.squee@daum.net">
            <i class="fa fa-envelope-o"></i>
            <span class="username">jb.squee@daum.net</span>
          </a>
        </li>
      </ul>
    </div>

  </div>

</footer>

<!-- Scripts -->
<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/js/lightbox.min.js"></script>

<script type="text/javascript">
$(document).ready(function() {
  // Default syntax highlighting
  hljs.initHighlightingOnLoad();

  // Header
  var menuToggle = $('#js-mobile-menu').unbind();
  $('#js-navigation-menu').removeClass("show");
  menuToggle.on('click', function(e) {
    e.preventDefault();
    $('#js-navigation-menu').slideToggle(function(){
      if($('#js-navigation-menu').is(':hidden')) {
        $('#js-navigation-menu').removeAttr('style');
      }
    });
  });
});

</script>




<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-112755509-1', 'auto');
  ga('send', 'pageview', {
    'page': '/devbook/2018/03/04/9791186978825.html',
    'title': '이펙티브 파이썬 - 클래스와 상속'
  });
</script>



  </body>

</html>
